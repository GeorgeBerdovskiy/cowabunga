from lstore.db import Database
from lstore.query import Query

from cowabunga_rs import table_module, buffer_pool_module
from time import process_time
from random import choice, randrange

db = Database()
grades_table = db.create_table('Grades', 5, 3)
query = Query(grades_table)

query.insert(*[8, -2, 8, 0, 6])
query.select(0, 3, [0, 1, 0, 1, 1])
query.select(0, 3, [0, 0, 0, 0, 1])
query.sum(-10, 6, 1)
query.update(0, *[None, -3, None, 0, -2])
query.select(9, 1, [1, 1, 1, 1, 1])
query.select(-3, 0, [1, 1, 0, 1, 1])
query.insert(*[-5, 9, 2, 9, 2])
query.insert(*[-6, 7, 3, -5, 1])
query.select(-5, 3, [0, 1, 1, 1, 1])
query.sum(-7, 3, 3)
query.insert(*[-10, -10, 5, 1, -8])
query.sum(-1, 1, 2)
query.update(9, *[-5, None, 9, 9, None])
query.update(1, *[-7, 5, -7, 1, None])
query.select(0, 3, [1, 1, 0, 0, 0])
query.select_version(-3, 0, [0, 1, 1, 1, 1], -8)
query.select_version(2, 2, [1, 1, 0, 1, 0], -7)
query.select(0, 3, [0, 0, 0, 1, 1])
query.update(9, *[None, None, 4, 9, -6])
query.select(0, 3, [1, 1, 1, 0, 1])
query.select(-5, 3, [1, 1, 0, 1, 0])
query.insert(*[-7, 8, -9, -9, -7])
query.update(1, *[None, 1, None, 1, None])
for res in query.select_version(-2, 4, [1, 0, 0, 1, 0], 0):
    print(f"- {res.columns}")
# [ERROR] Last select version returned primary key 8 but it shouldn't have.